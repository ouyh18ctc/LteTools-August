using System.IO;
using System.Linq;
using Lte.Domain.LinqToCsv.Description;
using Lte.Domain.Regular;
using Lte.Evaluations.Kpi;
using Lte.Parameters.Kpi.Abstract;
using Lte.Parameters.Kpi.Entities;
using NUnit.Framework;
using Moq;

namespace Lte.Evaluations.Test.Kpi
{
    [TestFixture]
    public class KpiStatImporterTest
    {
        private readonly Mock<ITopCellRepository<TopDrop2GCellDaily>> statRepository =
            new Mock<ITopCellRepository<TopDrop2GCellDaily>>();

        private KpiStatImporter importer;
        private int result;

        [SetUp]
        public void SetUp()
        {
            statRepository.MockOperations();
            importer = new KpiStatImporter(statRepository.Object, 100);
            result = 0;
        }

        [TestCase(@",载波,基站名称,掉话总次数,呼叫总次数,掉话率,RSSI均值,平均掉话ECIO,掉话平均距离,0-200米,200-400米,400-600米,600-800米,800-1000米,1000-1200米,1200-1400米,1400-1600米,1600-1800米,1800-2000米,2000-2200米,2200-2400米,2400-2600米,2600-2800米,2800-3000米,3000-4000米,4000-5000米,5000-6000米,6000-7000米,7000-8000米,8000-9000米,9000米以上,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23
CDR掉话次数,1_1377_1377_2_201,莱翔石瓷厂,160,6362,2.51,-85.0,-9.3,713.9,5,13,61,53,15,3,3,0,2,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,17,23,12,7,15,7,20,14,17,6,7,5,5,4,1
掉话Ecio,1_1377_1377_2_201,,,,,,,,-9.4,-8.8,-8.2,-9.6,-10.8,-10.5,-11.3,0.0,-22.0,0.0,0.0,-19.5,-12.5,-7.0,0.0,-9.0,0.0,0.0,0.0,-6.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-10.2,-9.2,-8.3,-9.1,-8.7,-10.0,-9.2,-9.2,-8.6,-9.9,-13.6,-9.6,-9.3,-8.6,-4.5
ECIO优良比,1_1377_1377_2_201,,,,,,,,0.69,0.77,0.75,0.56,0.45,0.39,0.26,0.26,0.16,0.46,0.44,0.38,0.57,0.33,0.86,0.82,0.50,0.00,0.00,1.00,0.00,0.00,,,,,,,,,,,,,,,,,,,,,,,,
呼叫次数,1_1377_1377_2_201,,,,,,,,235,1478,2615,1299,299,118,62,39,38,13,9,16,7,6,36,88,2,1,0,1,0,0,79,48,42,14,4,2,9,40,160,488,606,578,488,469,476,595,473,506,427,174,215,208,173,88
性能数据呼叫次数,1_1377_1377_2_201,莱翔石瓷厂,160,5672,2.82,,,,,,,,,,,,,,,,,,,,,,,,,,39,67,57,20,8,3,4,20,82,281,552,521,497,368,429,579,469,430,411,219,141,198,167,110
性能数据掉话次数,1_1377_1377_2_201,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
Erasuare掉话次数,1_1377_1377_2_201,,160,,100.00,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
告警次数,1_1377_1377_2_201,莱翔石瓷厂,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,RSSI问题:1;,,RSSI问题:3;,RSSI问题:1;,,,,,,,,,,,,
RSSI主集,1_1377_1377_2_201,,,,,-82.0851,,,,,,,,,,,,,,,,,,,,,,,,,-84,-84,-85,-85,-85,-84.5,-85,-84,-83.5,-82,-80.5,-80,-80,-80.5,-80.5,-80,-80,-80,-80.5,-81,-81.5,-81,-81.5,-82
RSSI分集,1_1377_1377_2_201,,,,,-109,,,,,,,,,,,,,,,,,,,,,,,,,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109
掉话原因,1_1377_1377_0_201,5_1975_0_201:2.13677km,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务,,1_1714_1714_1_201_优先级7_0话务,,,1_2239_2239_0_201_优先级8_0话务,1_2239_2239_0_201_优先级8_0话务,,1_46_46_1_283邻区问题;1_142_142_2_283邻区问题",
            2, new[] { "1_1377_1377_2_201", "1_1377_1377_0_201" })]
        [TestCase(@",载波,基站名称,掉话总次数,呼叫总次数,掉话率,RSSI均值,平均掉话ECIO,掉话平均距离,0-200米,200-400米,400-600米,600-800米,800-1000米,1000-1200米,1200-1400米,1400-1600米,1600-1800米,1800-2000米,2000-2200米,2200-2400米,2400-2600米,2600-2800米,2800-3000米,3000-4000米,4000-5000米,5000-6000米,6000-7000米,7000-8000米,8000-9000米,9000米以上,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23
CDR掉话次数,1_1377_1377_2_201,莱翔石瓷厂,160,6362,2.51,-85.0,-9.3,713.9,5,13,61,53,15,3,3,0,2,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,17,23,12,7,15,7,20,14,17,6,7,5,5,4,1
掉话Ecio,1_1377_1377_2_201,,,,,,,,-9.4,-8.8,-8.2,-9.6,-10.8,-10.5,-11.3,0.0,-22.0,0.0,0.0,-19.5,-12.5,-7.0,0.0,-9.0,0.0,0.0,0.0,-6.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-10.2,-9.2,-8.3,-9.1,-8.7,-10.0,-9.2,-9.2,-8.6,-9.9,-13.6,-9.6,-9.3,-8.6,-4.5
ECIO优良比,1_1377_1377_2_201,,,,,,,,0.69,0.77,0.75,0.56,0.45,0.39,0.26,0.26,0.16,0.46,0.44,0.38,0.57,0.33,0.86,0.82,0.50,0.00,0.00,1.00,0.00,0.00,,,,,,,,,,,,,,,,,,,,,,,,
呼叫次数,1_1377_1377_2_201,,,,,,,,235,1478,2615,1299,299,118,62,39,38,13,9,16,7,6,36,88,2,1,0,1,0,0,79,48,42,14,4,2,9,40,160,488,606,578,488,469,476,595,473,506,427,174,215,208,173,88
性能数据呼叫次数,1_1377_1377_2_201,莱翔石瓷厂,160,5672,2.82,,,,,,,,,,,,,,,,,,,,,,,,,,39,67,57,20,8,3,4,20,82,281,552,521,497,368,429,579,469,430,411,219,141,198,167,110
性能数据掉话次数,1_1377_1377_2_201,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
Erasuare掉话次数,1_1377_1377_2_201,,160,,100.00,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
告警次数,1_1377_1377_2_201,莱翔石瓷厂,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,RSSI问题:1;,,RSSI问题:3;,RSSI问题:1;,,,,,,,,,,,,
RSSI主集,1_1377_1377_2_201,,,,,-82.0851,,,,,,,,,,,,,,,,,,,,,,,,,-84,-84,-85,-85,-85,-84.5,-85,-84,-83.5,-82,-80.5,-80,-80,-80.5,-80.5,-80,-80,-80,-80.5,-81,-81.5,-81,-81.5,-82
RSSI分集,1_1377_133_2_201,,,,,-109,,,,,,,,,,,,,,,,,,,,,,,,,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109
掉话原因,1_1377_1377_0_201,5_1975_0_201:2.13677km,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务,,1_1714_1714_1_201_优先级7_0话务,,,1_2239_2239_0_201_优先级8_0话务,1_2239_2239_0_201_优先级8_0话务,,1_46_46_1_283邻区问题;1_142_142_2_283邻区问题",
            3, new[] { "1_1377_1377_2_201", "1_1377_133_2_201", "1_1377_1377_0_201" })]
        [TestCase(@",载波,基站名称,掉话总次数,呼叫总次数,掉话率,RSSI均值,平均掉话ECIO,掉话平均距离,0-200米,200-400米,400-600米,600-800米,800-1000米,1000-1200米,1200-1400米,1400-1600米,1600-1800米,1800-2000米,2000-2200米,2200-2400米,2400-2600米,2600-2800米,2800-3000米,3000-4000米,4000-5000米,5000-6000米,6000-7000米,7000-8000米,8000-9000米,9000米以上,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23
CDR掉话次数,1_1377_1377_2_201,莱翔石瓷厂,160,6362,2.51,-85.0,-9.3,713.9,5,13,61,53,15,3,3,0,2,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,17,23,12,7,15,7,20,14,17,6,7,5,5,4,1
掉话Ecio,1_1377_1377_2_201,,,,,,,,-9.4,-8.8,-8.2,-9.6,-10.8,-10.5,-11.3,0.0,-22.0,0.0,0.0,-19.5,-12.5,-7.0,0.0,-9.0,0.0,0.0,0.0,-6.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-10.2,-9.2,-8.3,-9.1,-8.7,-10.0,-9.2,-9.2,-8.6,-9.9,-13.6,-9.6,-9.3,-8.6,-4.5
ECIO优良比,1_1377_1377_2_201,,,,,,,,0.69,0.77,0.75,0.56,0.45,0.39,0.26,0.26,0.16,0.46,0.44,0.38,0.57,0.33,0.86,0.82,0.50,0.00,0.00,1.00,0.00,0.00,,,,,,,,,,,,,,,,,,,,,,,,
呼叫次数,1_1377_1377_2_201,,,,,,,,235,1478,2615,1299,299,118,62,39,38,13,9,16,7,6,36,88,2,1,0,1,0,0,79,48,42,14,4,2,9,40,160,488,606,578,488,469,476,595,473,506,427,174,215,208,173,88
性能数据呼叫次数,1_1377_1377_2_201,莱翔石瓷厂,160,5672,2.82,,,,,,,,,,,,,,,,,,,,,,,,,,39,67,57,20,8,3,4,20,82,281,552,521,497,368,429,579,469,430,411,219,141,198,167,110
性能数据掉话次数,1_1377_1377_2_201,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
Erasuare掉话次数,1_1377_1377_2_201,,160,,100.00,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
告警次数,1_1377_1377_2_201,莱翔石瓷厂,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,RSSI问题:1;,,RSSI问题:3;,RSSI问题:1;,,,,,,,,,,,,
RSSI主集,1_1365_1377_2_201,,,,,-82.0851,,,,,,,,,,,,,,,,,,,,,,,,,-84,-84,-85,-85,-85,-84.5,-85,-84,-83.5,-82,-80.5,-80,-80,-80.5,-80.5,-80,-80,-80,-80.5,-81,-81.5,-81,-81.5,-82
RSSI分集,1_1377_133_2_201,,,,,-109,,,,,,,,,,,,,,,,,,,,,,,,,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109
掉话原因,1_1377_1377_0_201,5_1975_0_201:2.13677km,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务,,1_1714_1714_1_201_优先级7_0话务,,,1_2239_2239_0_201_优先级8_0话务,1_2239_2239_0_201_优先级8_0话务,,1_46_46_1_283邻区问题;1_142_142_2_283邻区问题",
           4, new[] { "1_1377_1377_2_201", "1_1365_1377_2_201", "1_1377_133_2_201", "1_1377_1377_0_201" })]
        [TestCase(@",载波,基站名称,掉话总次数,呼叫总次数,掉话率,RSSI均值,平均掉话ECIO,掉话平均距离,0-200米,200-400米,400-600米,600-800米,800-1000米,1000-1200米,1200-1400米,1400-1600米,1600-1800米,1800-2000米,2000-2200米,2200-2400米,2400-2600米,2600-2800米,2800-3000米,3000-4000米,4000-5000米,5000-6000米,6000-7000米,7000-8000米,8000-9000米,9000米以上,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23
CDR掉话次数,1_1377_1377_2_201,莱翔石瓷厂,160,6362,2.51,-85.0,-9.3,713.9,5,13,61,53,15,3,3,0,2,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,17,23,12,7,15,7,20,14,17,6,7,5,5,4,1
掉话Ecio,1_1377_1377_2_201,,,,,,,,-9.4,-8.8,-8.2,-9.6,-10.8,-10.5,-11.3,0.0,-22.0,0.0,0.0,-19.5,-12.5,-7.0,0.0,-9.0,0.0,0.0,0.0,-6.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-10.2,-9.2,-8.3,-9.1,-8.7,-10.0,-9.2,-9.2,-8.6,-9.9,-13.6,-9.6,-9.3,-8.6,-4.5
ECIO优良比,1_1377_1377_2_201,,,,,,,,0.69,0.77,0.75,0.56,0.45,0.39,0.26,0.26,0.16,0.46,0.44,0.38,0.57,0.33,0.86,0.82,0.50,0.00,0.00,1.00,0.00,0.00,,,,,,,,,,,,,,,,,,,,,,,,
呼叫次数,1_1377_1377_2_201,,,,,,,,235,1478,2615,1299,299,118,62,39,38,13,9,16,7,6,36,88,2,1,0,1,0,0,79,48,42,14,4,2,9,40,160,488,606,578,488,469,476,595,473,506,427,174,215,208,173,88
性能数据呼叫次数,1_1377_1377_2_201,莱翔石瓷厂,160,5672,2.82,,,,,,,,,,,,,,,,,,,,,,,,,,39,67,57,20,8,3,4,20,82,281,552,521,497,368,429,579,469,430,411,219,141,198,167,110
性能数据掉话次数,1_1377_1377_2_201,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
Erasuare掉话次数,1_1377_1377_2_201,,160,,100.00,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
告警次数,1_1377_1377_2_283,莱翔石瓷厂,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,RSSI问题:1;,,RSSI问题:3;,RSSI问题:1;,,,,,,,,,,,,
RSSI主集,1_1365_1377_2_201,,,,,-82.0851,,,,,,,,,,,,,,,,,,,,,,,,,-84,-84,-85,-85,-85,-84.5,-85,-84,-83.5,-82,-80.5,-80,-80,-80.5,-80.5,-80,-80,-80,-80.5,-81,-81.5,-81,-81.5,-82
RSSI分集,1_1377_133_2_201,,,,,-109,,,,,,,,,,,,,,,,,,,,,,,,,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109
掉话原因,1_1377_1377_0_201,5_1975_0_201:2.13677km,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务,,1_1714_1714_1_201_优先级7_0话务,,,1_2239_2239_0_201_优先级8_0话务,1_2239_2239_0_201_优先级8_0话务,,1_46_46_1_283邻区问题;1_142_142_2_283邻区问题",
           5,
           new[] { "1_1377_1377_2_201", "1_1377_1377_2_283", "1_1365_1377_2_201", 
               "1_1377_133_2_201", "1_1377_1377_0_201" })]
        [TestCase(@",载波,基站名称,掉话总次数,呼叫总次数,掉话率,RSSI均值,平均掉话ECIO,掉话平均距离,0-200米,200-400米,400-600米,600-800米,800-1000米,1000-1200米,1200-1400米,1400-1600米,1600-1800米,1800-2000米,2000-2200米,2200-2400米,2400-2600米,2600-2800米,2800-3000米,3000-4000米,4000-5000米,5000-6000米,6000-7000米,7000-8000米,8000-9000米,9000米以上,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23
CDR掉话次数,1_1377_1377_2_201,莱翔石瓷厂,160,6362,2.51,-85.0,-9.3,713.9,5,13,61,53,15,3,3,0,2,0,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,17,23,12,7,15,7,20,14,17,6,7,5,5,4,1
掉话Ecio,1_1377_1377_2_201,,,,,,,,-9.4,-8.8,-8.2,-9.6,-10.8,-10.5,-11.3,0.0,-22.0,0.0,0.0,-19.5,-12.5,-7.0,0.0,-9.0,0.0,0.0,0.0,-6.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-10.2,-9.2,-8.3,-9.1,-8.7,-10.0,-9.2,-9.2,-8.6,-9.9,-13.6,-9.6,-9.3,-8.6,-4.5
ECIO优良比,1_1377_1377_2_201,,,,,,,,0.69,0.77,0.75,0.56,0.45,0.39,0.26,0.26,0.16,0.46,0.44,0.38,0.57,0.33,0.86,0.82,0.50,0.00,0.00,1.00,0.00,0.00,,,,,,,,,,,,,,,,,,,,,,,,
呼叫次数,1_1377_1377_2_201,,,,,,,,235,1478,2615,1299,299,118,62,39,38,13,9,16,7,6,36,88,2,1,0,1,0,0,79,48,42,14,4,2,9,40,160,488,606,578,488,469,476,595,473,506,427,174,215,208,173,88
性能数据呼叫次数,1_1377_1377_2_201,莱翔石瓷厂,160,5672,2.82,,,,,,,,,,,,,,,,,,,,,,,,,,39,67,57,20,8,3,4,20,82,281,552,521,497,368,429,579,469,430,411,219,141,198,167,110
性能数据掉话次数,1_1377_1377_2_201,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
Erasuare掉话次数,2_1377_1377_2_201,,160,,100.00,,,,,,,,,,,,,,,,,,,,,,,,,,0,0,0,0,0,0,0,0,0,8,18,19,13,7,15,10,19,11,13,6,10,4,4,3
告警次数,1_1377_1377_2_283,莱翔石瓷厂,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,RSSI问题:1;,,RSSI问题:3;,RSSI问题:1;,,,,,,,,,,,,
RSSI主集,1_1365_1377_2_201,,,,,-82.0851,,,,,,,,,,,,,,,,,,,,,,,,,-84,-84,-85,-85,-85,-84.5,-85,-84,-83.5,-82,-80.5,-80,-80,-80.5,-80.5,-80,-80,-80,-80.5,-81,-81.5,-81,-81.5,-82
RSSI分集,1_1377_133_2_201,,,,,-109,,,,,,,,,,,,,,,,,,,,,,,,,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109,-109
掉话原因,1_1377_1377_0_201,5_1975_0_201:2.13677km,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务;1_1714_1714_1_201_优先级7_0话务,1_1714_1714_0_201_优先级7_0话务,,1_1714_1714_1_201_优先级7_0话务,,,1_2239_2239_0_201_优先级8_0话务,1_2239_2239_0_201_优先级8_0话务,,1_46_46_1_283邻区问题;1_142_142_2_283邻区问题",
           6,
           new[] { "1_1377_1377_2_201", "2_1377_1377_2_201", "1_1377_1377_2_283", "1_1365_1377_2_201", 
               "1_1377_133_2_201", "1_1377_1377_0_201" })]
        public void Test_ImportStat(string csvContents, int count, string[] carries)
        {
            StreamReader reader = csvContents.GetStreamReader();
            Import(reader, count, carries);
        }

        private async void Import(StreamReader reader, int count, string[] carries)
        {
            result = await importer.ImportStat(reader, CsvFileDescription.CommaDescription);
            Assert.AreEqual(result, count);
            Assert.AreEqual(statRepository.Object.Stats.Count(), count);
            for (int i = 0; i < count; i++)
            {
                TopDrop2GCellDaily stat = statRepository.Object.Stats.ElementAt(i);
                string[] fields = carries[i].GetSplittedFields('_');
                Assert.AreEqual(stat.BscId, short.Parse(fields[0]));
                Assert.AreEqual(stat.BtsId, int.Parse(fields[1]));
                Assert.AreEqual(stat.CellId, int.Parse(fields[2]));
                Assert.AreEqual(stat.SectorId, byte.Parse(fields[3]));
                Assert.AreEqual(stat.Frequency, short.Parse(fields[4]));
            }
        }
    }
}
