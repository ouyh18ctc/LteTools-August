using System.Collections.Generic;
using System.Linq;
using Lte.Evaluations.Dingli;
using Lte.Domain.LinqToCsv.Context;
using NUnit.Framework;

namespace Lte.Evaluations.Test.Dingli
{
    [TestFixture]
    public class HandoverFailTest : TabCsvReader
    {
        private LogRecordRepository recordRepository;

        [SetUp]
        public void TestInitialize()
        {
            DescriptionInitialize();

            //41847:request
            //41874:fail
            testInput = @"Index	Time	Longitude	Latitude	eNodeBID	SectorID	Cell ID	PCI	RSRP (dBm)	SINR (dB)	PDSCH BLER	WideBand CQI	MCS Average UL /s	MCS Average DL /s	PDCP Throughput DL (bps)	PDCP Throughput UL (bps)	Event	Message Type	
41751	14:15:38:500	114.32204248062	22.6802511627907	491647	48	49164748	126	-81.25	13.40	8.39	8	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41752	14:15:38:500	114.32204372093	22.680251744186	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE_Cell_List	
41753	14:15:38:500	114.32204496124	22.6802523255814	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE ML1 PUSCH power control	
41754	14:15:38:562	114.32204620155	22.6802529069767	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE ML1 PUCCH power control	
41755	14:15:38:562	114.32204744186	22.6802534883721	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41756	14:15:38:562	114.322048682171	22.6802540697674	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE_PUCCH_Result	
41757	14:15:38:625	114.322049922481	22.6802546511628	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41758	14:15:38:687	114.322051162791	22.6802552325581	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE_PDCCH_PHICH	
41759	14:15:38:687	114.322052403101	22.6802558139535	491647	48	49164748	126	-84.93	11.70	8.39	8	21	10	25639392	473904		LTE LL1 PUSCH CSF log	
41760	14:15:38:687	114.322053643411	22.6802563953488	491647	48	49164748	126	-84.93	11.70	8.39	6	21	10	25639392	473904		LTE LL1 PUCCH CSF log	
41761	14:15:38:687	114.322054883721	22.6802569767442	491647	48	49164748	126	-84.93	11.70	8.39	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41762	14:15:38:750	114.322056124031	22.6802575581395	491647	48	49164748	126	-84.93	11.70	8.39	6	21	10	25639392	473904		LTE_PDCCH_Result	
41763	14:15:38:750	114.322057364341	22.6802581395349	491647	48	49164748	126	-84.93	11.70	8.39	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41764	14:15:38:750	114.322058604651	22.6802587209302	491647	48	49164748	126	-80.68	12.70	8.39	6	21	10	25639392	473904		LTE_Cell_List	
41765	14:15:38:812	114.322059844961	22.6802593023256	491647	48	49164748	126	-80.68	12.70	8.39	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41766	14:15:38:812	114.322061085271	22.6802598837209	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE_PDSCH_Stat	
41767	14:15:38:812	114.322062325581	22.6802604651163	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE LL1 PSS results	
41768	14:15:38:812	114.322063565891	22.6802610465116	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE LL1 SSS results	
41769	14:15:38:875	114.322064806202	22.680261627907	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41770	14:15:38:937	114.322066046512	22.6802622093023	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE LL1 PCFICH decoding results	
41771	14:15:38:937	114.322067286822	22.6802627906977	491647	48	49164748	126	-80.68	12.70	8.92	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41772	14:15:38:937	114.322068527132	22.680263372093	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE_Cell_List	
41773	14:15:39:000	114.322069767442	22.6802639534884	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41774	14:15:39:000	114.322071007752	22.6802645348837	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE ML1 PUSCH power control	
41775	14:15:39:062	114.322072248062	22.6802651162791	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE ML1 PUCCH power control	
41776	14:15:39:062	114.322073488372	22.6802656976744	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE_DCI_Info	
41777	14:15:39:062	114.322074728682	22.6802662790698	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41778	14:15:39:125	114.322075968992	22.6802668604651	491647	48	49164748	126	-84.12	8.90	8.92	6	21	10	25639392	473904		LTE ML1 Uplink PKT build indication	
41779	14:15:39:187	114.322077209302	22.6802674418605	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	25639392	473904		LTE_Cell_List	
41780	14:15:39:187	114.322078449612	22.6802680232558	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	25639392	473904		LTE LL1 PUSCH CSF log	
41781	14:15:39:187	114.322079689922	22.6802686046512	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE_Thr	
41782	14:15:39:187	114.322080930233	22.6802691860465	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41783	14:15:39:250	114.322082170543	22.6802697674419	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE_PUSCH_Stat	
41784	14:15:39:250	114.322083410853	22.6802703488372	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE LL1 PUCCH CSF log	
41785	14:15:39:250	114.322084651163	22.6802709302326	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41786	14:15:39:375	114.322085891473	22.6802715116279	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41787	14:15:39:375	114.322087131783	22.6802720930233	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE LL1 PSS results	
41788	14:15:39:375	114.322088372093	22.6802726744186	491647	48	49164748	126	-81.93	7.90	8.92	6	21	10	21118912	402624		LTE LL1 SSS results	
41789	14:15:39:437	114.322089612403	22.680273255814	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE_Cell_List	
41790	14:15:39:437	114.322090852713	22.6802738372093	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41791	14:15:39:437	114.322092093023	22.6802744186047	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE LL1 PCFICH decoding results	
41792	14:15:39:437	114.322093333333	22.680275	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41793	14:15:39:500	114.322094487179	22.6802755555556	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41794	14:15:39:500	114.322095641026	22.6802761111111	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 PUSCH power control	
41795	14:15:39:500	114.322096794872	22.6802766666667	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 PUCCH power control	
41796	14:15:39:562	114.322097948718	22.6802772222222	491647	48	49164748	126	-82.37	11.10	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41797	14:15:39:625	114.322099102564	22.6802777777778	491647	48	49164748	126	-85.81	6.10	8.92	6	21	10	21118912	402624		LTE_Cell_List	
41798	14:15:39:625	114.32210025641	22.6802783333333	491647	48	49164748	126	-85.81	6.10	8.92	6	21	10	21118912	402624		LTE_PUCCH_Result	
41799	14:15:39:625	114.322101410256	22.6802788888889	491647	48	49164748	126	-85.81	6.10	8.92	6	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41800	14:15:39:687	114.322102564103	22.6802794444444	491647	48	49164748	126	-85.81	6.10	8.92	10	21	10	21118912	402624		LTE LL1 PUSCH CSF log	
41801	14:15:39:687	114.322103717949	22.68028	491647	48	49164748	126	-85.81	6.10	8.92	10	21	10	21118912	402624		LTE_PDCCH_PHICH	
41802	14:15:39:687	114.322104871795	22.6802805555556	491647	48	49164748	126	-85.81	6.10	8.92	10	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41803	14:15:39:750	114.322106025641	22.6802811111111	491647	48	49164748	126	-85.81	6.10	8.92	10	21	10	21118912	402624		LTE_PDCCH_Result	
41804	14:15:39:750	114.322107179487	22.6802816666667	491647	48	49164748	126	-85.81	6.10	8.92	10	21	10	21118912	402624		LTE ML1 Uplink PKT build indication	
41805	14:15:39:812	114.322108333333	22.6802822222222	491647	48	49164748	126	-85.81	6.10	8.92	6	21	10	21118912	402624		LTE LL1 PUCCH CSF log	
41806	14:15:39:812	114.322109487179	22.6802827777778	491647	48	49164748	126	-82.12	10.90	8.92	6	21	10	21118912	402624		LTE_Cell_List	
41807	14:15:39:812	114.322110641026	22.6802833333333	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE_PDSCH_Stat	
41808	14:15:39:812	114.322111794872	22.6802838888889	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41809	14:15:39:875	114.322112948718	22.6802844444444	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41810	14:15:39:937	114.322114102564	22.680285	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE LL1 PCFICH decoding results	
41811	14:15:39:937	114.32211525641	22.6802855555556	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE LL1 PSS results	
41812	14:15:39:937	114.322116410256	22.6802861111111	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE LL1 SSS results	
41813	14:15:40:000	114.322117564103	22.6802866666667	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41814	14:15:40:000	114.322118717949	22.6802872222222	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41815	14:15:40:000	114.322119871795	22.6802877777778	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 PUSCH power control	
41816	14:15:40:062	114.322121025641	22.6802883333333	491647	48	49164748	126	-82.12	10.90	9.61	6	21	8	21118912	402624		LTE ML1 PUCCH power control	
41817	14:15:40:062	114.322122179487	22.6802888888889	491647	48	49164748	126	-77.87	12.00	9.61	6	21	8	21118912	402624		LTE_Cell_List	
41818	14:15:40:062	114.322123333333	22.6802894444444	491647	48	49164748	126	-77.87	12.00	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41819	14:15:40:062	114.322124487179	22.68029	491647	48	49164748	126	-77.87	12.00	9.61	6	21	8	21118912	402624		LTE_DCI_Info	
41820	14:15:40:125	114.322125641026	22.6802905555556	491647	48	49164748	126	-77.87	12.00	9.61	6	21	8	21118912	402624		LTE ML1 Uplink PKT build indication	
41821	14:15:40:187	114.322126794872	22.6802911111111	491647	48	49164748	126	-77.87	12.00	9.61	8	21	8	21118912	402624		LTE LL1 PUSCH CSF log	
41822	14:15:40:187	114.322127948718	22.6802916666667	491647	48	49164748	126	-77.87	12.00	9.61	8	21	8	20359280	397440		LTE_Thr	
41823	14:15:40:187	114.322129102564	22.6802922222222	491647	48	49164748	126	-77.87	12.00	9.61	8	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41824	14:15:40:250	114.32213025641	22.6802927777778	491647	48	49164748	126	-81.37	9.40	9.61	8	21	8	20359280	397440		LTE_Cell_List	
41825	14:15:40:250	114.322131410256	22.6802933333333	491647	48	49164748	126	-81.37	9.40	9.61	8	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41826	14:15:40:250	114.322132564103	22.6802938888889	491647	48	49164748	126	-81.37	9.40	9.61	8	21	8	20359280	397440		LTE_PUSCH_Stat	
41827	14:15:40:312	114.322133717949	22.6802944444444	491647	48	49164748	126	-81.37	9.40	9.61	8	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41828	14:15:40:375	114.322134871795	22.680295	491647	48	49164748	126	-81.37	9.40	9.61	5	21	8	20359280	397440		LTE LL1 PUCCH CSF log	
41829	14:15:40:375	114.322136025641	22.6802955555556	491647	48	49164748	126	-81.37	9.40	9.61	5	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41830	14:15:40:437	114.322137179487	22.6802961111111	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE_Cell_List	
41831	14:15:40:437	114.322138333333	22.6802966666667	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE LL1 PCFICH decoding results	
41832	14:15:40:500	114.322138624709	22.6802967948718	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41833	14:15:40:500	114.322138916084	22.6802969230769	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41834	14:15:40:500	114.322139207459	22.6802970512821	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE LL1 PSS results	
41835	14:15:40:500	114.322139498834	22.6802971794872	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE LL1 SSS results	
41836	14:15:40:500	114.32213979021	22.6802973076923	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 PUSCH power control	
41837	14:15:40:562	114.322140081585	22.6802974358974	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 PUCCH power control	
41838	14:15:40:562	114.32214037296	22.6802975641026	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41839	14:15:40:625	114.322140664336	22.6802976923077	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE_PUCCH_Result	
41840	14:15:40:625	114.322140955711	22.6802978205128	491647	48	49164748	126	-82.00	10.00	9.61	5	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41841	14:15:40:687	114.322141247086	22.6802979487179	491647	48	49164748	126	-82.00	10.00	9.61	8	21	8	20359280	397440		LTE LL1 PUSCH CSF log	
41842	14:15:40:687	114.322141538462	22.6802980769231	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE_Cell_List	
41843	14:15:40:687	114.322141829837	22.6802982051282	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE_PDCCH_PHICH	
41844	14:15:40:750	114.322142121212	22.6802983333333	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41845	14:15:40:750	114.322142412587	22.6802984615385	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE RRC-->Measurement Report	
41846	14:15:40:750	114.322142703963	22.6802985897436	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE_PDCCH_Result	
41847	14:15:40:828	114.322142995338	22.6802987179487	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440	RRC Connection ReconfigurationLTE Handover Request;	LTE RRC-->RRC Connection Reconfiguration	
41848	14:15:40:828	114.322143286713	22.6802988461538	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE ML1 Uplink PKT build indication	
41849	14:15:40:890	114.322143578089	22.680298974359	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE MAC configuration	
41850	14:15:40:890	114.322143869464	22.6802991025641	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE RLC DL configuration	
41851	14:15:40:890	114.322144160839	22.6802992307692	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE RLC UL configuration	
41852	14:15:40:890	114.322144452214	22.6802993589744	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE PDCP DL config	
41853	14:15:40:890	114.32214474359	22.6802994871795	491647	48	49164748	126	-84.12	6.40	9.61	8	21	8	20359280	397440		LTE PDCP UL config	
41854	14:15:40:890	114.322145034965	22.6802996153846														LTE NAS EMM state	
41855	14:15:40:890	114.32214532634	22.6802997435897														UMTS NAS Reg State	
41856	14:15:40:953	114.322145617716	22.6802998717949														LTE LL1 PBCH decoding results	
41857	14:15:40:953	114.322145909091	22.6803														LTE ML1 Serving Cell Information log packet	
41858	14:15:40:953	114.322146200466	22.6803001282051														LTE ML1 Serving Cell Information log packet	
41859	14:15:41:078	114.322146491841	22.6803002564103														LTE ML1 Serving Cell Information log packet	
41860	14:15:41:078	114.322146783217	22.6803003846154														LTE ML1 initial acquisition results	
41861	14:15:41:078	114.322147074592	22.6803005128205														LTE ML1 Serving Cell Information log packet	
41862	14:15:41:078	114.322147365967	22.6803006410256				355										LTE MIB message	
41863	14:15:41:078	114.322147657343	22.6803007692308				355			10.32			9				LTE_PDSCH_Stat	
41864	14:15:41:078	114.322147948718	22.6803008974359	489835	48	48983548	355			10.32			9				LTE RRC-->System Information Block Type 1	
41865	14:15:41:078	114.322148240093	22.680301025641	489835	48	48983548	355			10.32			9				LTE RRC-->System Information Blocks	
41866	14:15:41:078	114.322148531469	22.6803011538462	489835	48	48983548	355			10.32			9				LTE ML1 S criteria check procedure	
41867	14:15:41:078	114.322148822844	22.6803012820513	489835	48	48983548	355			10.32			9				LTE ML1 downlink common configuration	
41868	14:15:41:078	114.322149114219	22.6803014102564	489835	48	48983548	355			10.32			9				LTE ML1 grant manager common configuration	
41869	14:15:41:078	114.322149405594	22.6803015384615	489835	48	48983548	355			10.32			9				LTE ML1 downlink dedicated configuration	
41870	14:15:41:078	114.32214969697	22.6803016666667	489835	48	48983548	355			10.32			9				LTE ML1 grant manager dedicated configuration	
41871	14:15:41:078	114.322149988345	22.6803017948718	489835	48	48983548	355			10.32			9				LTE MAC configuration	
41872	14:15:41:078	114.32215027972	22.6803019230769	489835	48	48983548	355			10.32			9				LTE ML1 PRACH configuration	
41873	14:15:41:078	114.322150571096	22.6803020512821	489835	48	48983548	355			10.32			9				LTE serving cell info	
41874	14:15:41:078	114.322150862471	22.6803021794872	489835	48	48983548	355			10.32			9			RRC Connection Reestablish RequestLTE Handover Failure;	LTE RRC-->Connection Reestablishment Request	
41875	14:15:41:171	114.322151153846	22.6803023076923	489835	48	48983548	355			10.32			9				LTE ML1 random access request (MSG1) report	
41876	14:15:41:171	114.322151445221	22.6803024358974	489835	48	48983548	355			10.32			9			LTE Random Access Msg1	Prach: MSG1(RA)	
41877	14:15:41:171	114.322151736597	22.6803025641026	489835	48	48983548	355			10.32			9				LTE LL1 RACH Tx report	
41878	14:15:41:171	114.322152027972	22.6803026923077	489835	48	48983548	355			10.32			9				LTE ML1 random access response (MSG2) report	
41879	14:15:41:171	114.322152319347	22.6803028205128	489835	48	48983548	355			10.32			9			LTE Random Access Msg2	Prach: MSG2(RAR)	
41880	14:15:41:171	114.322152610723	22.680302948718	489835	48	48983548	355			10.32			9				LTE ML1 UE identification message (MSG3) Report	
41881	14:15:41:171	114.322152902098	22.6803030769231	489835	48	48983548	355			10.32			9			LTE Random Access Msg3	Prach: MSG3	
41882	14:15:41:171	114.322153193473	22.6803032051282	489835	48	48983548	355			10.32			9				LTE LL1 PCFICH decoding results	
41883	14:15:41:171	114.322153484848	22.6803033333333	489835	48	48983548	355			10.32			9				LTE ML1 contention resolution message (MSG4) report	
41884	14:15:41:171	114.322153776224	22.6803034615385	489835	48	48983548	355			10.32			9			LTE Random Access Msg4	Prach: MSG4	
41885	14:15:41:171	114.322154067599	22.6803035897436	489835	48	48983548	355			10.32			9			RRC Connection Reestablish Reject	LTE RRC-->RRC Connection Reestablishment Reject	
41886	14:15:41:171	114.322154358974	22.6803037179487	489835	48	48983548	355			10.32			9				LTE MAC configuration	
41887	14:15:41:171	114.32215465035	22.6803038461538	489835	48	48983548	355			10.32			9				LTE RLC DL configuration	
41888	14:15:41:171	114.322154941725	22.680303974359	489835	48	48983548	355			10.32			9				LTE RLC UL configuration	
41889	14:15:41:171	114.3221552331	22.6803041025641	489835	48	48983548	355			10.32			9				LTE PDCP DL config	
41890	14:15:41:171	114.322155524476	22.6803042307692	489835	48	48983548	355			10.32			9				LTE PDCP UL config	
41891	14:15:41:171	114.322155815851	22.6803043589744	489835	48	48983548	355			10.32			9				LTE NAS EMM state	
41892	14:15:41:171	114.322156107226	22.6803044871795	489835	48	48983548	355			10.32			9				LTE ML1 S criteria check procedure	
41893	14:15:41:171	114.322156398601	22.6803046153846	489835	48	48983548	355			10.32			9				LTE ML1 downlink common configuration	
41894	14:15:41:171	114.322156689977	22.6803047435897	489835	48	48983548	355			10.32			9				LTE ML1 grant manager common configuration	
41895	14:15:41:171	114.322156981352	22.6803048717949	489835	48	48983548	355			10.32			9				LTE NAS EMM state	
41896	14:15:41:171	114.322157272727	22.680305	489835	48	48983548	355			10.32			9				Removable User Identity Module Debug	
41897	14:15:41:171	114.322157564103	22.6803051282051	489835	48	48983548	355			10.32			9				LTE ML1 downlink dedicated configuration	
41898	14:15:41:171	114.322157855478	22.6803052564103	489835	48	48983548	355			10.32			9				LTE ML1 grant manager dedicated configuration	
41899	14:15:41:171	114.322158146853	22.6803053846154	489835	48	48983548	355			10.32			9				LTE MAC configuration	
41900	14:15:41:171	114.322158438228	22.6803055128205	489835	48	48983548	355			10.32			9				LTE ML1 PRACH configuration	
41901	14:15:41:171	114.322158729604	22.6803056410256	489835	48	48983548	355			10.32			9				Removable User Identity Module Debug	
41902	14:15:41:171	114.322159020979	22.6803057692308	489835	48	48983548	355			10.32			9				LTE_DCI_Info	
41903	14:15:41:171	114.322159312354	22.6803058974359	489835	48	48983548	355			10.32			9				LTE ML1 PUSCH power control	
41904	14:15:41:171	114.32215960373	22.680306025641	489835	48	48983548	355			10.32			9				LTE ML1 PUCCH power control	
41905	14:15:41:171	114.322159895105	22.6803061538462	489835	48	48983548	355			10.32			9				LTE ML1 Uplink PKT build indication	
41906	14:15:41:171	114.32216018648	22.6803062820513	489835	48	48983548	355			10.32			9				Removable User Identity Module Debug	
41907	14:15:41:171	114.322160477855	22.6803064102564	489835	48	48983548	355			10.32			9	8618608	159080		LTE_Thr	
41908	14:15:41:171	114.322160769231	22.6803065384615	489835	48	48983548	355			10.32			9	8618608	159080		Removable User Identity Module Debug	
41909	14:15:41:171	114.322161060606	22.6803066666667	489835	48	48983548	355			10.32			9	8618608	159080		LTE LL1 PSS results	
41910	14:15:41:171	114.322161351981	22.6803067948718	489835	48	48983548	355			10.32			9	8618608	159080		LTE LL1 SSS results	
41911	14:15:41:281	114.322161643357	22.6803069230769	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 Serving Cell Information log packet	
41912	14:15:41:343	114.322161934732	22.6803070512821	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 Serving Cell Information log packet	
41913	14:15:41:343	114.322162226107	22.6803071794872	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 Serving Cell Information log packet	
41914	14:15:41:406	114.322162517483	22.6803073076923	489835	48	48983548	355			10.32			9	8618608	159080		LTE RRC-->System Information Block Type 1	
41915	14:15:41:406	114.322162808858	22.6803074358974	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 Serving Cell Information log packet	
41916	14:15:41:406	114.322163100233	22.6803075641026	489835	48	48983548	355			10.32			9	8618608	159080		LTE MIB message	
41917	14:15:41:406	114.322163391608	22.6803076923077	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 S criteria check procedure	
41918	14:15:41:406	114.322163682984	22.6803078205128	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 downlink common configuration	
41919	14:15:41:406	114.322163974359	22.680307948718	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 grant manager common configuration	
41920	14:15:41:406	114.322164265734	22.6803080769231	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 downlink dedicated configuration	
41921	14:15:41:406	114.32216455711	22.6803082051282	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 grant manager dedicated configuration	
41922	14:15:41:406	114.322164848485	22.6803083333333	489835	48	48983548	355			10.32			9	8618608	159080		LTE MAC configuration	
41923	14:15:41:406	114.32216513986	22.6803084615385	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 PRACH configuration	
41924	14:15:41:406	114.322165431235	22.6803085897436	489835	48	48983548	355			10.32			9	8618608	159080		LTE serving cell info	
41925	14:15:41:406	114.322165722611	22.6803087179487	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 UE Mobility state change	
41926	14:15:41:406	114.322166013986	22.6803088461539	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 idle measurement request	
41927	14:15:41:406	114.322166305361	22.680308974359	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 idle IRAT measurement request	
41928	14:15:41:406	114.322166596737	22.6803091025641	489835	48	48983548	355			10.32			9	8618608	159080		LTE NAS EMM state	
41929	14:15:41:406	114.322166888112	22.6803092307692	489835	48	48983548	355			10.32			9	8618608	159080		UMTS NAS Reg State	
41930	14:15:41:406	114.322167179487	22.6803093589744	489835	48	48983548	355			10.32			9	8618608	159080		LTE NAS EMM state	
41931	14:15:41:406	114.322167470862	22.6803094871795	489835	48	48983548	355			10.32			9	8618608	159080			
41932	14:15:41:406	114.322167762238	22.6803096153846	489835	48	48983548	355			10.32			9	8618608	159080		LTE NAS EMM security protected OTA outgoing msg	
41933	14:15:41:406	114.322168053613	22.6803097435897	489835	48	48983548	355			10.32			9	8618608	159080	RRC Connection Request	LTE RRC-->RRC Connection Request	
41934	14:15:41:406	114.322168344988	22.6803098717949	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 random access request (MSG1) report	
41935	14:15:41:406	114.322168636364	22.68031	489835	48	48983548	355			10.32			9	8618608	159080	LTE Random Access Msg1	Prach: MSG1(RA)	
41936	14:15:41:406	114.322168927739	22.6803101282051	489835	48	48983548	355			10.32			9	8618608	159080		LTE LL1 RACH Tx report	
41937	14:15:41:406	114.322169219114	22.6803102564103	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 random access response (MSG2) report	
41938	14:15:41:406	114.32216951049	22.6803103846154	489835	48	48983548	355			10.32			9	8618608	159080	LTE Random Access Msg2	Prach: MSG2(RAR)	
41939	14:15:41:406	114.322169801865	22.6803105128205	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 UE identification message (MSG3) Report	
41940	14:15:41:406	114.32217009324	22.6803106410256	489835	48	48983548	355			10.32			9	8618608	159080	LTE Random Access Msg3	Prach: MSG3	
41941	14:15:41:406	114.322170384615	22.6803107692308	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 contention resolution message (MSG4) report	
41942	14:15:41:406	114.322170675991	22.6803108974359	489835	48	48983548	355			10.32			9	8618608	159080	LTE Random Access Msg4	Prach: MSG4	
41943	14:15:41:406	114.322170967366	22.680311025641	489835	48	48983548	355			10.32			9	8618608	159080	RRC Connection Setup Received	LTE RRC-->RRC Connection Setup	
41944	14:15:41:406	114.322171258741	22.6803111538462	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 downlink dedicated configuration	
41945	14:15:41:406	114.322171550117	22.6803112820513	489835	48	48983548	355			10.32			9	8618608	159080		LTE ML1 grant manager dedicated configuration	
41946	14:15:41:406	114.322171841492	22.6803114102564	489835	48	48983548	355			10.32			9	8618608	159080		LTE MAC configuration	
41947	14:15:41:406	114.322172132867	22.6803115384615	489835	48	48983548	355			10.32			9	8618608	159080		LTE RLC DL configuration	
41948	14:15:41:406	114.322172424242	22.6803116666667	489835	48	48983548	355			10.32			9	8618608	159080		LTE RLC UL configuration	
41949	14:15:41:406	114.322172715618	22.6803117948718	489835	48	48983548	355			10.32			9	8618608	159080		LTE PDCP DL config	
41950	14:15:41:406	114.322173006993	22.6803119230769	489835	48	48983548	355			10.32			9	8618608	159080		LTE PDCP UL config	
41951	14:15:41:406	114.322173298368	22.6803120512821	489835	48	48983548	355			10.32			9	8618608	159080	RRC Connection Completed	LTE RRC-->RRC Connection Setup Complete	
41952	14:15:41:406	114.322173589744	22.6803121794872	489835	48	48983548	355			10.32	9		9	8618608	159080		LTE LL1 PUCCH CSF log	
41953	14:15:41:406	114.322173881119	22.6803123076923	489835	48	48983548	355			10.32	9		9	8618608	159080		Removable User Identity Module Debug	
41954	14:15:41:406	114.322174172494	22.6803124358974	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE_PUSCH_Stat	
41955	14:15:41:468	114.322174463869	22.6803125641026	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE RRC-->System Information Block Type 1	
41956	14:15:41:468	114.322174755245	22.6803126923077	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE RRC-->Security Mode Command	
41957	14:15:41:468	114.32217504662	22.6803128205128	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE PDCP DL config	
41958	14:15:41:468	114.322175337995	22.680312948718	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE PDCP UL config	
41959	14:15:41:468	114.322175629371	22.6803130769231	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE RRC-->Security Mode Complete	
41960	14:15:41:468	114.322175920746	22.6803132051282	489835	48	48983548	355			10.32	9	20	9	8618608	159080	RRC Connection Reconfiguration	LTE RRC-->RRC Connection Reconfiguration	
41961	14:15:41:468	114.322176212121	22.6803133333333	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE ML1 grant manager dedicated configuration	
41962	14:15:41:468	114.322176503497	22.6803134615385	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE MAC configuration	
41963	14:15:41:468	114.322176794872	22.6803135897436	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE RLC DL configuration	
41964	14:15:41:468	114.322177086247	22.6803137179487	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE RLC UL configuration	
41965	14:15:41:468	114.322177377622	22.6803138461539	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE PDCP DL config	
41966	14:15:41:468	114.322177668998	22.680313974359	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE PDCP UL config	
41967	14:15:41:468	114.322177960373	22.6803141025641	489835	48	48983548	355			10.32	9	20	9	8618608	159080		LTE NAS EMM state	
41968	14:15:41:468	114.322178251748	22.6803142307692				354			10.32	9	20	9	8618608	159080	RRC Connection Reconfiguration Complete	LTE RRC-->RRC Connection Reconfiguration Complete	
41969	14:15:41:468	114.322178543124	22.6803143589744				354			10.32	9	20	9	8618608	159080		Removable User Identity Module Debug	
41970	14:15:41:468	114.322178834499	22.6803144871795				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE_Cell_List	
41971	14:15:41:468	114.322179125874	22.6803146153846				355	-77.12	21.20	10.32	9	20	9	8618608	159080	RRC Connection Reconfiguration	LTE RRC-->RRC Connection Reconfiguration	
41972	14:15:41:468	114.322179417249	22.6803147435898				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE ML1 UE Mobility state change	
41973	14:15:41:468	114.322179708625	22.6803148717949				355	-77.12	21.20	10.32	9	20	9	8618608	159080	RRC Connection Reconfiguration Complete	LTE RRC-->RRC Connection Reconfiguration Complete	
41974	14:15:41:468	114.32218	22.680315				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE RRC-->Measurement Report	
41975	14:15:41:531	114.322181008772	22.6803154385965				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE ML1 Uplink PKT build indication	
41976	14:15:41:593	114.322182017544	22.680315877193				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE ML1 Uplink PKT build indication	
41977	14:15:41:656	114.322183026316	22.6803163157895				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE_PUCCH_Result	
41978	14:15:41:656	114.322184035088	22.680316754386				355	-77.12	21.20	10.32	9	20	9	8618608	159080		LTE LL1 PCFICH decoding results	
41979	14:15:41:656	114.32218504386	22.6803171929825				355	-79.68	18.60	10.32	9	20	9	8618608	159080		LTE_Cell_List	
41980	14:15:41:656	114.322186052632	22.680317631579				355	-79.68	18.60	10.32	9	20	9	8618608	159080		LTE ML1 Uplink PKT build indication";
            recordRepository = new LogRecordRepository
            {
                LogRecordList = CsvContext.ReadString<LogRecord>(testInput, fileDescription_namesUs).ToList().Merge()
            };
            LogRecordRepository.ThroughputCalculationDelay = 1;
        }

        [Test]
        public void TestHandoverFail()
        {
            List<HandoverInfo> handoverInfoList = recordRepository.GetHandoverInfoList();
            Assert.IsNotNull(handoverInfoList);
            Assert.AreEqual(recordRepository.LogRecordList.Count, 48);
            Assert.AreEqual(handoverInfoList.Count, 1);
            Assert.AreEqual(handoverInfoList[0].HandoverSuccess, false);
            Assert.AreEqual(handoverInfoList[0].RequestTime.Hour, 14);
            Assert.AreEqual(handoverInfoList[0].RequestTime.Minute, 15);
            Assert.AreEqual(handoverInfoList[0].RequestTime.Second, 40);
            Assert.AreEqual(handoverInfoList[0].RequestTime.Millisecond, 828);
            Assert.AreEqual(handoverInfoList[0].RequestLongitude, 114.3221433, 1E-6);
            Assert.AreEqual(handoverInfoList[0].RequestLatitude, 22.6802988, 1E-6);
            Assert.AreEqual(handoverInfoList[0].PciBefore, 126);
            Assert.AreEqual(handoverInfoList[0].ENodebIdBefore, 491647);
            Assert.AreEqual(handoverInfoList[0].SectorIdBefore, 48);
            Assert.AreEqual(handoverInfoList[0].RsrpBefore, -84.12);
            Assert.AreEqual(handoverInfoList[0].FinishedTime.Hour, 14);
            Assert.AreEqual(handoverInfoList[0].FinishedTime.Minute, 15);
            Assert.AreEqual(handoverInfoList[0].FinishedTime.Second, 41);
            Assert.AreEqual(handoverInfoList[0].FinishedTime.Millisecond, 78);
            Assert.AreEqual(handoverInfoList[0].FinishLongtitude, 114.3221509, 1E-6);
            Assert.AreEqual(handoverInfoList[0].FinishLatitude, 22.6803022, 1E-6);
            Assert.AreEqual(handoverInfoList[0].PciAfter, 355);
            Assert.AreEqual(handoverInfoList[0].ENodebIdAfter, 489835);
            Assert.AreEqual(handoverInfoList[0].SectorIdAfter, 48);
            Assert.AreEqual(handoverInfoList[0].RsrpAfter, 0);
            Assert.AreEqual(handoverInfoList[0].DlThroughputBefore, 20663132);
            Assert.AreEqual(handoverInfoList[0].DlThroughputAfter, 8618608);
            Assert.AreEqual(handoverInfoList[0].UlThroughputBefore, 399513);
            Assert.AreEqual(handoverInfoList[0].UlThroughputAfter, 159080);
        }
    }
}
